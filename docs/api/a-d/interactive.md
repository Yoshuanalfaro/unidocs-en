
# 互动游戏
# interactive game

## 简介
## Introduction

互动游戏是DCloud联合三方服务商为开发者提供新的广告场景增值服务。开发者在App中放置入口，用户点击入口参与权益化、趣味性的活动。通过观看激励视频广告加速获取权益。沉浸的游戏体验能够降低对广告的抵触心理，增加激励视频广告展示的同时有效提高广告收益。
Interactive games are DCloud and third-party service providers to provide developers with new value-added services for advertising scenarios. The developer places the entrance in the App, and the user clicks the entrance to participate in the equity and interesting activities. Accelerate your benefits by watching rewarded video ads. An immersive gaming experience can reduce resistance to ads, increase the display of rewarded video ads, and effectively increase ad revenue.

![](https://web-assets.dcloud.net.cn/unidoc/zh/interactive1.png)


## 活动场景类型：
## Active scene type:

共抽奖类、游戏类、养成类3种场景类型，开发者可根据自身情况选择活动类型：
There are three types of scenarios: lottery, game, and development. Developers can choose the type of activity according to their own situation:

1. 抽奖类活动：通过转盘、扭蛋、摇骰子等抽奖玩法获得奖品碎片或红包奖励
1. Sweepstakes activities: obtain prize fragments or red envelopes through sweepstakes such as turntable, gashapon, and dice shaking
2. 游戏类活动：通过合成游戏、成语答题、捕鱼等游戏玩法获得金币或红包奖励
2. Game activities: get gold coins or red envelopes through synthetic games, idiom answering, fishing and other gameplay
3. 养成类活动：果园、农场、养牛等长期活动，用户通过连续签到、道具收集、任务体系等玩法提升养成对象的等级，升级后可获得红包奖励或兑换奖品
3. Cultivation activities: long-term activities such as orchards, farms, and cattle raising. Users can improve the level of the cultivation objects through continuous check-in, item collection, task system and other gameplay. After upgrading, they can get red envelopes or exchange prizes

![](https://web-assets.dcloud.net.cn/unidoc/zh/interactive2.jpg)

### 活动分类表
### Activity classification table
<table>
	<thead style="background-color: #f8f8f8;">
		<tr>
			<td>活动分类</td>
			<td>activity classification</td>
			<td>活动名称</td>
			<td>Event name</td>
			<td>发放奖励</td>
			<td>Give out rewards</td>
			<td>活动周期</td>
			<td>activity cycle</td>
			<td>是否支持积分打通</td>
			<td>Whether to support the integration of points</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td rowspan="3">抽奖</td>
			<td rowspan="3">lottery</td>
			<td>集碎片</td>
			<td>set fragment</td>
			<td>多奖品</td>
			<td>multiple prizes</td>
			<td>7天</td>
			<td></td>
		</tr>
		<tr>
			<td>印钞机</td>
			<td>money printing machine</td>
			<td>现金</td>
			<td>cash</td>
			<td>7天</td>
			<td></td>
		</tr>
		<tr>
			<td>扭蛋机</td>
			<td>gashapon machine</td>
			<td>多奖品</td>
			<td>multiple prizes</td>
			<td>7天</td>
			<td></td>
		</tr>
		<tr>
			<td rowspan="4">游戏</td>
			<td rowspan="4">game</td>
			<td>大富翁</td>
			<td>Monopoly</td>
			<td>现金</td>
			<td>cash</td>
			<td>7天</td>
			<td>7 days</td>
			<td>支持</td>
			<td>support</td>
		</tr>
		<tr>
			<td>成语大赢家</td>
			<td>Idiom big winner</td>
			<td>现金</td>
			<td>cash</td>
			<td>7天</td>
			<td></td>
		</tr>
		<tr>
			<td>合成招财猫</td>
			<td>Synthetic Lucky Cat</td>
			<td>现金</td>
			<td>cash</td>
			<td>7天</td>
			<td></td>
		</tr>
		<tr>
			<td>捕鱼达人</td>
			<td>fishing expert</td>
			<td>现金</td>
			<td>cash</td>
			<td>长期</td>
			<td>long</td>
			<td>新增支持</td>
			<td>Added support</td>
		</tr>
		<tr>
			<td rowspan="5">养成</td>
			<td rowspan="5">cultivate</td>
			<td>福牛</td>
			<td>Blessed Bull</td>
			<td>现金</td>
			<td>cash</td>
			<td>7天</td>
			<td></td>
		</tr>
		<tr>
			<td>果园</td>
			<td>orchard</td>
			<td>水果</td>
			<td>fruit</td>
			<td>长期</td>
			<td></td>
		</tr>
		<tr>
			<td>农场</td>
			<td>farm</td>
			<td>现金</td>
			<td>cash</td>
			<td>30天</td>
			<td></td>
		</tr>
		<tr>
			<td>养鸡</td>
			<td>chicken raising</td>
			<td>现金</td>
			<td>cash</td>
			<td>长期</td>
			<td></td>
		</tr>
		<tr>
			<td>走路赚</td>
			<td>walk to earn</td>
			<td>现金</td>
			<td>cash</td>
			<td>7天</td>
			<td>7 days</td>
			<td>支持</td>
			<td>support</td>
		</tr>
	</tbody>
</table>

注：如要选择对应的活动，请在创建互动游戏广告位时把对应的活动名称填入到广告位名称内，创建后不可修改，如需修改，请邮件联系[uniad@dcloud.io](mailto:uniad@dcloud.io)
Note: If you want to select the corresponding activity, please fill in the corresponding activity name into the ad slot name when creating an interactive game ad slot. It cannot be modified after creation. If you need to modify it, please email [uniad@dcloud.io]( mailto:uniad@dcloud.io)

## 关于奖励发放的说明
## Instructions on Reward Distribution

互动游戏的目的是吸引用户参与活动，引导用户观看广告，通过活动获取奖励，满足特定条件后需要向用户发放奖励。目前有两种奖励发放方式，一种是由DCloud联合三方服务商为开发者提供用户奖励线下代发；一种是由开发者对接App自身积分系统，将用户奖励转换为App积分，提高用户参与度和体验。
The purpose of interactive games is to attract users to participate in activities, guide users to watch advertisements, obtain rewards through activities, and issue rewards to users after meeting certain conditions. There are currently two ways to issue rewards. One is that DCloud and third-party service providers provide developers with offline distribution of user rewards; the other is that developers connect with the app's own points system to convert user rewards into app points to increase user Engagement and experience.

### 用户奖励线下代发服务
### User reward offline service
默认使用用户奖励线下代发服务，具体说明如下：
By default, the offline proxy service of user rewards is used, and the details are as follows:
1. 用户参与以上活动达到一定资产时（奖品碎片或金币到达兑换门槛，红包金额到达提现门槛），可发起兑奖申请。如用户申请提现，需要填写收款的支付宝或微信账号；如用户申请兑换虚拟或者实物奖品，需要填写联系人联系方式和收货地址等；具体以兑奖弹窗为准。
1. When the user participates in the above activities and reaches a certain amount of assets (the reward fragments or gold coins reach the exchange threshold, and the red envelope amount reaches the withdrawal threshold), they can initiate a redemption application. If the user applies for cash withdrawal, he needs to fill in the Alipay or WeChat account for the payment; if the user applies to exchange virtual or physical prizes, he needs to fill in the contact information and delivery address, etc.;
2. 用户提交兑奖申请后，客服将在5个工作日内确认，确认后将尽快为您进行发货，如实物奖品有发货时间较长等问题请联系客服。
2. After the user submits the application for redemption, the customer service will confirm it within 5 working days, and will deliver the prize as soon as possible after confirmation.
3. 如实物奖品（水果生鲜等）因为时令问题、疫情区域或者新疆、西藏等偏远地区暂时无法寄送，客服将联系用户赠送奖品价值相等的现金奖励。
3. If physical prizes (fresh fruits, etc.) cannot be sent temporarily due to seasonal problems, epidemic areas, or remote areas such as Xinjiang and Tibet, customer service will contact the user to present a cash reward equal to the value of the prize.
4. 实物奖品发放后,快递配送请在24小时内收货,如有质量问题,请于签收后48小时内进行售后申请,超出时间不予赔付。
4. After the physical prize is distributed, please receive the goods within 24 hours for express delivery. If there is any quality problem, please apply for after-sales within 48 hours after signing. No compensation will be made beyond the time limit.
5. 用户不得使用任何外挂、插件以及其他破坏破坏活动规则、违背活动公平原则的方式参加本次活动，否则服务商有权取消用户参与活动的资格以及清空获得的奖励。
5. Users are not allowed to use any plug-ins, plug-ins and other methods that violate the rules of the activity and violate the principle of fairness to participate in this activity, otherwise the service provider has the right to disqualify the user from participating in the activity and clear the rewards obtained.


### 用户奖励对接App积分
### User rewards for docking app points

积分对接需要开发者业务系统与三方服务商的互动游戏进行对接，需要一定的开发工作量，请邮件联系[uniad@dcloud.io](mailto:uniad@dcloud.io)
The integration of points requires the connection between the developer's business system and the interactive games of the third-party service providers, which requires a certain amount of development work. Please email [uniad@dcloud.io](mailto:uniad@dcloud.io)

**平台差异说明**
**Platform Difference Description**

|App|H5|微信小程序|支付宝小程序|百度小程序|字节跳动小程序、飞书小程序|QQ小程序|快手小程序|京东小程序|
|App|H5|WeChat applet|Alipay applet|Baidu applet|ByteDance applet, Feishu applet|QQ applet|Kaishou applet|Jingdong applet|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|App 3.1.15+|x|x|x|x|x|x|x|x|

**开通配置广告**
**Activate configuration advertisement**

[开通广告步骤详情](https://uniapp.dcloud.net.cn/uni-ad.html#start)
[Details of the steps to activate advertising](https://uniapp.dcloud.net.cn/uni-ad.html#start)

注意：打包时必须选择要集成的广告SDK互动游戏(变现猫)，优量汇、穿山甲、快手至少选择其中一个。
Note: When packaging, you must select the advertising SDK interactive game (realization cat) to be integrated, at least one of Youlianghui, Pangolin, and Kuaishou.

### 语法
### grammar

`uni.createInteractiveAd(options)`

### 参数说明
### Parameter Description

`options` 为 object 类型，属性如下：
`options` is of type object with the following attributes:

|属性名		|类型		|必填	|描述			|
|Attribute Name |Type |Required |Description |
|:-:|:-:|:-:|:-:|
|adpid	  |string	|	是 |广告位 id |
|adpid |string | Yes |Ad Slot id |
|provider	|string	|	是 |服务商标识，即插件id|
|provider |string | is |provider ID, i.e. plugin id|
|userData	|object	|	否 |对接App积分系统参数 |
|userData |object | No |Integrated App Points System Parameters |


`provider` 值：
`provider` value:

|值		|描述			|
|value |description |
|:-:|:-:|
|BXM-AD	  |互动游戏变现猫|
|BXM-AD |Interactive Game Realization Cat|



### 广告创建
### Ad Creation

广告组件默认是隐藏的，因此可以提前创建，以提前初始化组件。开发者可以在页面的 onReady 事件回调中创建广告实例，并在该页面的生命周期内重复调用该广告实例。
The ad component is hidden by default, so it can be created ahead of time to initialize the component early. Developers can create an ad instance in the page's onReady event callback, and call the ad instance repeatedly during the page's life cycle.


### 显示/隐藏
### show/hide

广告组件默认是隐藏的，开发者需要调用 CreateInteractiveAd.show() 进行显示。如果广告拉取失败或触发频率限制，CreateInteractiveAd.show() 方法会返回一个rejected Promise，开发者可自行监听错误信息
The ad component is hidden by default, and the developer needs to call CreateInteractiveAd.show() to display it. If the ad pull fails or the frequency limit is triggered, the CreateInteractiveAd.show() method will return a rejected Promise, and the developer can monitor the error message by himself

```js
CreateInteractiveAd.show().catch((err) => {
  console.error(err)
})
```

用户可以主动关闭广告。开发者不可控制广告组件的隐藏。
Users can actively close ads. The developer has no control over the hiding of ad components.


### 监听广告加载成功事件
### Listen for the successful ad loading event

如果广告加载成功，通过 CreateInteractiveAd.onLoad() 注册的回调函数会执行，回调函数返回广告素材参数。
If the ad loads successfully, the callback function registered with CreateInteractiveAd.onLoad() is executed, and the callback function returns the creative parameters.


|属性名		|类型		|描述			|
|property name |type |description |
|:-:|:-:|:-:|
|imgUrl	  |string	|	广告素材图片的url地址 |
|imgUrl |string | URL of the creative image |


```js
CreateInteractiveAd.onLoad(res => {
    console.log('图片素材地址', res.imgUrl);
    console.log('广告加载成功');
})
```


HBuilder基座的测试广告位 adpid: `1042956255` (游戏); `1620839118` (抽奖); `1064042976` (养成)
Test ad slot of HBuilder base adpid: `1042956255` (game); `1620839118` (lottery); `1064042976` (cultivation)


示例代码
sample code

```html
<template>
  <view>
    <image class="ad-icon" v-if="imgUrl" :src="imgUrl" @click="showInteractiveAd"></image>
  </view>
</template>

<script>
  export default {
    data() {
      return {
        title: '互动游戏',
        loading: false,
        imgUrl: ""
      }
    },
    onReady() {
      this.adOption = {
        adpid: '1042956255',
        provider: 'BXM-AD'
      };

      // 创建广告实例
			// create ad instance
      this.createInteractiveAd();
    },
    methods: {
      createInteractiveAd() {
        var interactiveAd = this.interactiveAd = uni.createInteractiveAd(this.adOption);
        interactiveAd.onLoad((e) => {
          this.loading = false;
          this.imgUrl = e.imgUrl;
          console.log("广告加载成功");
          // 如果有广告图片素材, 通过 e.imgUrl 获取
					// If there is an ad image material, get it through e.imgUrl
        });
        interactiveAd.onClose(() => {
          // 用户点击了关闭或返回键(仅Android有返回键)
          // User clicked close or back button (only Android has back button)
          console.log("广告关闭");
        });
        interactiveAd.onError((err) => {
          this.loading = false;
          console.log("广告加载失败");
        });

        // 广告实例创建成功后默认会执行一次 load，加载广告数据
				// After the ad instance is created successfully, a load will be executed by default to load the ad data
        // 如果界面有 "显示广告" 按钮，需要先禁用掉，防止用户点击，等待广告数据加载成功后在放开
				// If there is a "Show Ads" button on the interface, you need to disable it first to prevent users from clicking, wait for the ad data to be loaded successfully, and then release it
        this.loading = true;
      },
      showInteractiveAd() {
        // 调用 interactiveAd.show()，如果数据正在加载中不会显示广告，加载成功后才显示
				// Call interactiveAd.show(), if the data is loading, the ad will not be displayed, and it will be displayed after the loading is successful
        // 在数据没有加载成功时，需要防止用户频繁点击显示广告
				// When the data is not loaded successfully, it is necessary to prevent the user from frequently clicking on the display ad
        if (this.loading == true) {
          return
        }
        this.loading = true;
        this.interactiveAd.show().then(() => {
          this.loading = false;
        });
      }
    },
    onUnload() {
      // 页面关闭后销毁实例
			// Destroy the instance after the page is closed
      this.interactiveAd.destroy();
    }
  }
</script>
<style>
  .ad-icon {
    display: block;
    width: 80px;
    height: 80px;
    margin: 10px;
  }
</style>
```


#### 方法
#### method

`Promise CreateInteractiveAd.load()`

加载广告。
Load ad.

`Promise CreateInteractiveAd.show()`

显示广告。
Display ads.

`CreateInteractiveAd.reportExposure()`

场景入口曝光打点。
Scene entrance exposure dots.

`CreateInteractiveAd.destroy()`

销毁广告实例。
Destroy the ad instance.

`CreateInteractiveAd.onLoad(function callback)`

监听广告加载事件。
Listen for ad load events.

`CreateInteractiveAd.offLoad(function callback)`

取消监听广告加载事件
Cancel listening for ad load event

`CreateInteractiveAd.onError(function callback)`

监听错误事件。
Listen for error events.

`CreateInteractiveAd.offError(function callback)`

取消监听错误事件
Cancel listening for error events


### 积分对接
### Points docking

### 开通
### Open

1. 开发者需要提供广告位 `adpid`
1. The developer needs to provide the ad slot `adpid`
2. 开发者需要提供服务器接口
2. Developers need to provide a server interface
  1. 获取积分接口
  1. Get points interface
  2. 操作积分接口
  2. Operation integration interface
3. 三方服务商需要提供 `secretKey` 让开发者来验签请求来源
3. The third-party service provider needs to provide `secretKey` for developers to verify the source of the request


### 获取积分
### Earn points

简要描述：
A brief description:

该接口用于获取用户总积分数量；
This interface is used to obtain the total number of user points;

开发者提供url用户查询积分
Developers provide url user query points

请求方式 `GET`
Request method `GET`

参数：
parameter:

|参数名|必选|类型|说明|
|Parameter name|Required|Type|Description|
|:-:|:-:|:-:|:-:|
|appUserId|是|String|app用户Id|
|appUserId| is |String|app UserId|
|appId|是|String|SSP后台注册的appId|
|appId| is |String|appId registered in the SSP background|
|timestamp|是|String|时间戳（自1970年起，精确到毫秒）|
|timestamp| is |String| timestamp (since 1970, milliseconds accurate)|
|sign|是|String|签名,用于验证身份。按照按 secretKey + timestamp 的进行MD5加密（注意加密后字符串要转大写，不要加上“+”号）|
|sign| is the |String| signature used to verify identity. Perform MD5 encryption according to secretKey + timestamp (note that the encrypted string should be capitalized without adding a "+" sign)|

返回参数说明
Return parameter description

|参数名|类型|说明|
|parameter name|type|description|
|:-:|:-:|:-:|
|appUserId|String|app用户Id|
|appUserId|String|appUserId|
|avatar|String|用户头像|
|avatar|String|User Avatar|
|nickname|String|用户昵称|
|nickname|String|User nickname|
|amount|Long|用户总积分|
|amount|Long|Total User Points|

示例
example

```json
  {
   "appUserId" : "dcloud",
   "avatar": "https://xxx.yyy.com/xxxx.jpg",
   "nickname": "jack",
   "amount": 100
  }
```

### 操作积分
### Operation Points

简要描述：
A brief description:

此接口用于操作用户积分数量，如增加、扣除；
This interface is used to operate the number of user points, such as adding and deducting;
请求参数放在body里，以JSON格式提交；
The request parameters are placed in the body and submitted in JSON format;
考虑到接口的安全，建议开发者采用IP白名单+签名的方式校验来源，以防备被第三方利用。
Considering the security of the interface, it is recommended that developers use the IP whitelist + signature method to verify the source to prevent being used by third parties.


失败情况：
Failure:

- URL存在特殊字符或无法通过外网访问；
- The URL has special characters or cannot be accessed through the external network;
- 没有按照响应格式要求返回的内容；
- Content that is not returned as required by the response format;
- 接口返回状态码非`200`的情况；
- When the interface returns a status code other than `200`;
- 接口响应时间超过`3`秒。
- The interface response time exceeds `3` seconds.

开发者提供url用户查询积分
Developers provide url user query points

请求方式 `POST`
Request method `POST`

参数：
parameter:

|参数名|必选|类型|说明|
|Parameter name|Required|Type|Description|
|:-:|:-:|:-:|:-:|
|appUserId|是|String|App用户Id(唯一标识)|
|appUserId| is |String|App user ID (unique identifier)|
|appId|是|String|SSP后台注册的appId|
|appId| is |String|appId registered in the SSP background|
|operateType|是|Long|操作类型：1.增加 2.扣除|
|operateType| is |Long|Operation type: 1. Add 2. Deduct|
|amount|是|Long|本次操作的积分值|
|amount| is |Long| the integral value of this operation|
|timestamp|是|String|时间戳（自1970年起，精确到毫秒）|
|timestamp| is |String| timestamp (since 1970, milliseconds accurate)|
|sign|是|String|签名，用于验证身份。按照按 secretKey + timestamp 进行MD5加密（注意加密后字符串要转大写，不要加上“+”号）|
|sign| is the |String| signature used to verify identity. Perform MD5 encryption according to secretKey + timestamp (note that the encrypted string should be capitalized without adding a "+" sign)|

返回参数说明
Return parameter description

|参数名|类型|说明|
|parameter name|type|description|
|:-:|:-:|:-:|
|appUserId|String|App用户Id(唯一标识)|
|appUserId|String|App User Id (Unique ID)|
|status|int|状态码：0. 处理失败 1. 处理成功|
|status|int|Status code: 0. Processing failed 1. Processing successful|
|message|String|失败原因|
|message|String|Failure Reason|
|amount|Long|操作后的用户总积分|
|amount|Long|Total points of users after operation|

返回结果示例
Example of return result
```json
{
  "appUserId": "dcloud",
  "status": 1,
  "amount": 100
}
```
